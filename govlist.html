<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mains and farms</title>
  <style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: var(--bg-color);
  color: var(--text-color);
}
:root {
  --bg-color: #e5e5e5;
  --text-color: #333;
  --table-bg: #fff;
  --table-border: #ccc;
  --accent: #fff;
  --scrollbar-bg: rgba(0,0,0,0.3);
  --checkmark-color: #666;
  --row-selected-bg: #cce5ff;
  --row-selected-text: #000;
  --chart-line: #007bff;
}

body.dark {
  --bg-color: #1c1c1c;
  --text-color: #eee;
  --table-bg: #2a2a2a;
  --table-border: #444;
  --accent: #2a2a2a;
  --scrollbar-bg: rgba(255,255,255,0.4);
  --checkmark-color: white;
  --row-selected-bg: #004085;
  --row-selected-text: #fff;
  --chart-line: #ff9800;
}
/* =========================================================
   3. NAVIGATION BAR
   ========================================================= */
 /* --- Navbar --- */
 .navbar {
   position: sticky;
   top: 8px;
   z-index: 999;
   width: 75%;
   margin: 0 auto;
   background: rgba(255, 255, 255, 0.8);
   backdrop-filter: blur(12px);
   -webkit-backdrop-filter: blur(12px);
   border-radius: 20px;
   box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
   padding: 10px 24px;
   transition: all 0.3s ease;
 }
 
 .nav-container {
   display: flex;
   align-items: center;
   justify-content: space-between;
 }
 
 .nav-links {
   flex: 1;
   display: flex;
   justify-content: center;
   gap: 28px;
 }
 
 .nav-links a {
   text-decoration: none;
   font-weight: 500;
   color: #053b6b;
   transition: color 0.3s;
 }
 
 .nav-links a:hover {
   color: var(--accent);
 }
 
 .theme-toggle {
   display: flex;
   align-items: center;
   gap: 8px;
   cursor: pointer;
   background: none;
   border: none;
   color: #053b6b;
   font-size: 16px;
   margin-left: auto;
 }
 
 .theme-toggle input {
   display: none;
 }
 
 .toggle-slider {
   position: relative;
   width: 50px;
   height: 24px;
   background-color: #ccc;
   border-radius: 12px;
   transition: background-color 0.3s;
 }
 
 .toggle-slider::before {
   content: "";
   position: absolute;
   top: 3px;
   left: 3px;
   width: 18px;
   height: 18px;
   background-color: white;
   border-radius: 50%;
   transition: transform 0.3s;
 }
 
 .theme-toggle input:checked + .toggle-slider {
   background-color: #ff9800;
 }
 
 .theme-toggle input:checked + .toggle-slider::before {
   transform: translateX(26px);
 }
 
 .hamburger {
   display: none;
   font-size: 22px;
   background: none;
   border: none;
   color: #053b6b;
   cursor: pointer;
 }
 
 body.dark .navbar {
   background: rgba(26, 26, 26, 0.85);
   border: 1px solid rgba(255, 255, 255, 0.05);
   box-shadow: 0 4px 18px rgba(0, 0, 0, 0.5);
 }
 
 body.dark .nav-links a {
   color: #eee;
 }
 
 body.dark .nav-links a:hover {
   color: #ff9800;
 }
 
 body.dark .theme-toggle {
   color: #eee;
 }
 
 body.dark .hamburger {
   color: #eee;
 }
    .container {
      padding: 2rem;
      max-width: 900px;
      margin: auto;
    }
    .table-container {
      background: white;
      border-radius: 10px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
      padding: 1rem;
      margin-bottom: 2rem;
    }
    h2 {
      color: #4338ca;
      margin-bottom: 1rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 0.6rem;
      text-align: left;
    }
    th {
      background: #f3f4f6;
    }
    tr:hover {
      background: #f9fafb;
    }
    .no-results {
      text-align: center;
      color: #6b7280;
      margin-top: 2rem;
    }

body.dark .table-container {
  background: #2a2a2a;
  box-shadow: 0 4px 18px rgba(0, 0, 0, 0.4);
}

body.dark th {
background: #2a2a2a;
}

body.dark tr:hover {
      background: rgba(0,123,255,0.1);
    }
.table-container label {
  margin-right: 8px;
  font-weight: 600;
}

.table-container select {
  margin-right: 16px;
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid var(--table-border);
}

input {
  width: 200px !important;
  max-width: 100%;
  padding: 5px 7px !important;
  border-radius: 8px !important;
  border: 1px solid #ccc !important;
   background: rgba(255, 255, 255, 0.8);
   backdrop-filter: blur(12px);
   -webkit-backdrop-filter: blur(12px);
  color: #333 !important;
  font-size: 14px !important;
}
input::placeholder  {
  color: var(--text-color) !important;
  opacity: 0.8 !important;
}
body.dark input {
   background: rgba(26, 26, 26, 0.85);
   border: 1px solid rgba(255, 255, 255, 0.05);
  color: #eee !important;

}
  </style>
</head>
<body>
    <header class="navbar">
      <div class="nav-container">
        <button class="hamburger" id="hamburger" aria-label="Menu">â˜°</button>
        <div class="nav-links" id="nav-links">
          <a href="index.html">Dashboard</a>
          <a href="compare.html">Compare</a>
          <a href="dkp.html">DKP Calculator</a>
          <a href="merge.html">Merge</a>
          <a href="govinfo.html">Governor info</a>
        </div>
    	<input type="text" id="search" placeholder="Search by ID or Name...">
        <label class="theme-toggle">
          ðŸŒž
          <input type="checkbox" id="toggle-theme">
          <span class="toggle-slider"></span>
          ðŸŒ™
        </label>
      </div>
    </header>

  <div class="container" id="tablesContainer"></div>
  <p class="no-results" id="noResults" style="display:none;">No results found.</p>

  <script>
    const SHEET_ID = "14sAyLcrQmFinhsEj8JIf8-IXgPs27fGHFBB3w5h2MuQ";
    const SHEET_NAME = "Sheet1";
    const API_KEY = "AIzaSyAPP27INsgILZBAigyOm-g31djFgYlU7VY";

    const container = document.getElementById("tablesContainer");
    const searchInput = document.getElementById("search");
    const noResults = document.getElementById("noResults");
    let allGroups = [];

    async function fetchData() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
      try {
        const res = await fetch(url);
        const data = await res.json();
        const rows = data.values;

        const headers = rows[0].map(h => h.trim());
        const items = rows.slice(1).map(r => {
          const obj = {};
          headers.forEach((h, i) => obj[h] = r[i] || "");
          return obj;
        });

        allGroups = groupByMain(items);
        renderTables(allGroups);
      } catch (err) {
        console.error("Error fetching sheet data:", err);
        container.innerHTML = "<p style='color:red;'>Failed to load data. Check your API key or sheet permissions.</p>";
      }
    }

    // Groups rows by MAIN â†’ FARMS (based on order in sheet)
    function groupByMain(items) {
      const groups = [];
      let currentMain = null;

      for (const row of items) {
        if (row["Account Type"] === "MAIN") {
          currentMain = {
            id: row["ID"],
            name: row["Name"],
            ch: row["CH"],
            farms: []
          };
          groups.push(currentMain);
        } else if (row["Account Type"] === "FARM" && currentMain) {
          currentMain.farms.push({
            id: row["ID"],
            name: row["Name"],
            ch: row["CH"]
          });
        }
      }
      return groups;
    }

    function renderTables(groups, filter = "") {
      container.innerHTML = "";

      let filtered = groups;
      if (filter) {
        const f = filter.toLowerCase();
        filtered = groups.filter(
          g =>
            g.name.toLowerCase().includes(f) ||
            g.id.toLowerCase().includes(f) ||
            g.farms.some(fm => fm.name.toLowerCase().includes(f) || fm.id.toLowerCase().includes(f))
        );
      }

      if (filtered.length === 0) {
        noResults.style.display = "block";
        return;
      } else {
        noResults.style.display = "none";
      }

      filtered.forEach(gov => {
        const tableContainer = document.createElement("div");
        tableContainer.className = "table-container";

        const header = document.createElement("h2");
        header.textContent = `${gov.id} â€” ${gov.name} â€” ${gov.ch}`;
        tableContainer.appendChild(header);

        const table = document.createElement("table");
        const thead = document.createElement("thead");
        thead.innerHTML = `
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>CH</th>
          </tr>
        `;
        table.appendChild(thead);

        const tbody = document.createElement("tbody");
        gov.farms.forEach(farm => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${farm.id}</td>
            <td>${farm.name}</td>
            <td>${farm.ch}</td>
          `;
          tbody.appendChild(row);
        });

        table.appendChild(tbody);
        tableContainer.appendChild(table);
        container.appendChild(tableContainer);
      });
    }

    searchInput.addEventListener("input", e => {
      renderTables(allGroups, e.target.value);
    });

    fetchData();

// Theme toggle
const themeToggle = document.getElementById("toggle-theme");
if (localStorage.getItem("theme") === "dark") {
  document.body.classList.add("dark");
  themeToggle.checked = true;
}

themeToggle.addEventListener("change", () => {
  document.body.classList.toggle("dark", themeToggle.checked);
  localStorage.setItem(
    "theme",
    document.body.classList.contains("dark") ? "dark" : "light"
  );
});

// Mobile nav
const hamburger = document.getElementById("hamburger");
const navLinks = document.getElementById("nav-links");
hamburger.addEventListener("click", () => navLinks.classList.toggle("show"));
  </script>
</body>
</html>
