<!DOCTYPE html>
<html>
<head>
  <title>Excel Merger</title>
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
  <h2>Excel Merge Tool</h2>
  
  <input type="file" id="file1" accept=".xlsx" />
  <input type="file" id="file2" accept=".xlsx" />
  <button id="merge">Merge Files</button>

  <script>
    async function readExcel(file) {
      const data = await file.arrayBuffer();
      const workbook = XLSX.read(data, { type: "array" });
      const sheetName = workbook.SheetNames[0];
      return XLSX.utils.sheet_to_json(workbook.Sheets[sheetName]);
    }

    function mergeData(file1Data, file2Data, idColumn, mergeColumn) {
      const map = {};
      for (const row of file2Data) {
        map[row[idColumn]] = row[mergeColumn];
      }
      for (const row of file1Data) {
        const id = row[idColumn];
        if (map[id] !== undefined) {
          row[mergeColumn] = map[id];
        }
      }
      return file1Data;
    }

    document.getElementById("merge").addEventListener("click", async () => {
      const file1 = document.getElementById("file1").files[0];
      const file2 = document.getElementById("file2").files[0];
      if (!file1 || !file2) return alert("Please select both files.");

      const file1Data = await readExcel(file1);
      const file2Data = await readExcel(file2);

      // You can later make these dynamic (user selects columns)
      const merged = mergeData(file1Data, file2Data, "ID", "Value");

      const ws = XLSX.utils.json_to_sheet(merged);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Merged");
      XLSX.writeFile(wb, "merged.xlsx");
    });
  </script>
</body>
</html>
