<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DKP stats</title>
  <script src="
https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js
"></script>

<link rel="stylesheet" href="https://cdn.datatables.net/2.3.5/css/dataTables.dataTables.css" />
  
<script src="https://cdn.datatables.net/2.3.5/js/dataTables.js"></script>
  <style>
    div.dt-container {
        width: 800px;
        margin: 0 auto;
    }
  </style>
</head>

<body>

<table id="myTable"></table>
<script>
const API_KEY = "AIzaSyAZoyI5MbKsUJBe71jcn8AgU5ejFzdrteI";
const SPREADSHEET_ID = "1bP7LMwUuN3gjIEWKo0QCStKmrvIzn9rrYedoaUJh5zg";
const SHEET_NAME = "19_10_2025";   // change if necessary

async function loadSheetData() {
    const url =
        `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;

    const res = await fetch(url);
    const json = await res.json();

    if (!json.values) {
        console.error("No data returned from Google Sheets");
        return;
    }

    // First row is column headers
    const headers = json.values[0];

    // Remaining rows are table data
    const rows = json.values.slice(1);

    // Build Datatables column structure
    const dtColumns = headers.map(h => ({ title: h }));

    // Initialize DataTables
   let table = new DataTable('#myTable', {
    data: rows,
    columns: dtColumns,
    order: [],
    info: true,
    paging: true,
    scrollCollapse: true,
    scrollX: true,
    scrollY: "200px",
    pageLength: 50,
    language: {
        lengthLabels: {
            '-1': 'Show all'
        }
    },
    lengthMenu: [10, 25, 50, -1],

    columnDefs: [
        // Column 3 with diff in column 12
        {
            targets: 2,
            render: function (data, type, row) {
                return `${data}<br><span style="color:#888;">(${row[11]})</span>`;
            }
        },
        // Column 4 with diff in column 13
        {
            targets: 3,
            render: function (data, type, row) {
                return `${data}<br><span style="color:#888;">(${row[12]})</span>`;
            }
        },
        // Column 5 with diff in column 14
        {
            targets: 4,
            render: function (data, type, row) {
                return `${data}<br><span style="color:#888;">(${row[13]})</span>`;
            }
        },
        // Column 6 with diff in column 15
        {
            targets: 5,
            render: function (data, type, row) {
                return `${data}<br><span style="color:#888;">(${row[14]})</span>`;
            }
        },
        // Column 16 with diff in column 15 (adjust if needed)
        {
            targets: 15,
            render: function (data, type, row) {
                return `${data}<br><span style="color:#888;">(${row[14]})</span>`;
            }
        }
    ]
});

}

loadSheetData();
  
</script>

</body>

</html>
